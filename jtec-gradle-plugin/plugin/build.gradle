/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Gradle plugin project to get you started.
 * For more details take a look at the Writing Custom Plugins chapter in the Gradle
 * User Manual available at https://docs.gradle.org/7.5.1/userguide/custom_plugins.html
 */

plugins {
    // Apply the Java Gradle plugin development plugin to add support for developing Gradle plugins
    id 'java'
    id 'java-gradle-plugin'
    id 'maven-publish'
}

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
    mavenLocal()
}

dependencies {
    implementation 'edu.tum.sse:jtec-agent:0.0.3-SNAPSHOT'
}

gradlePlugin {
    // Define the plugin
    plugins {
        jtec {
            id = 'edu.tum.sse.jtec.JtecGradlePlugin'
            implementationClass = 'edu.tum.sse.jtec.jtecGradlePlugin.JtecGradlePluginPlugin'
        }
    }
}

jar {
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
    manifest {
        attributes 'Implementation-Version': '0.0.6'
        attributes 'Premain-Class': 'edu.tum.sse.jtec.agent.JTeCAgent'
    }
//    from {
//        configurations
//                .runtimeClasspath
//                .collect {
//                    if(
//                    it.name.equalsIgnoreCase("jtec-agent-0.0.3-SNAPSHOT.jar")
//                    ) {
//                        zipTree(it)
//                    }
//                }
//    }
}


task sourcesJar(type: Jar) {
    classifier = 'sources'
    from sourceSets.main.allSource
}

task javadocJar(type: Jar) {
    classifier = "javadoc"
    from javadoc
}

artifacts {
    archives sourcesJar
    archives javadocJar
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId = 'edu.tum.sse'
            artifactId = 'jtec-gradle-plugin'
            version = '0.0.3-SNAPSHOT'

            from components.java
        }
    }
}